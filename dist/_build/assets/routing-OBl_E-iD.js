import{p as T,a as v,g as oe,q,v as H,e as B,w as ae,o as N,x as ce,y as ie,u as le,z as ue,B as fe,b as he}from"./web-Da4UlN4N.js";function de(){let e=new Set;function t(r){return e.add(r),()=>e.delete(r)}let n=!1;function s(r,o){if(n)return!(n=!1);const a={to:r,options:o,defaultPrevented:!1,preventDefault:()=>a.defaultPrevented=!0};for(const i of e)i.listener({...a,from:i.location,retry:u=>{u&&(n=!0),i.navigate(r,{...o,resolve:!1})}});return!a.defaultPrevented}return{subscribe:t,confirm:s}}let k;function X(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),k=window.history.state._depth}X();function Le(e){return{...e,_depth:window.history.state&&window.history.state._depth}}function je(e,t){let n=!1;return()=>{const s=k;X();const r=s==null?null:k-s;if(n){n=!1;return}r&&t(r)?(n=!0,window.history.go(-r)):e()}}const pe=/^(?:[a-z0-9]+:)?\/\//i,me=/^\/+|(\/)\/+$/g,ge="http://sr";function b(e,t=!1){const n=e.replace(me,"$1");return n?t||/^[?#]/.test(n)?n:"/"+n:""}function L(e,t,n){if(pe.test(t))return;const s=b(e),r=n&&b(n);let o="";return!r||t.startsWith("/")?o=s:r.toLowerCase().indexOf(s.toLowerCase())!==0?o=s+r:o=r,(o||"/")+b(t,!o)}function ye(e,t){if(e==null)throw new Error(t);return e}function ve(e,t){return b(e).replace(/\/*(\*.*)?$/g,"")+b(t)}function G(e){const t={};return e.searchParams.forEach((n,s)=>{t[s]=n}),t}function we(e,t,n){const[s,r]=e.split("/*",2),o=s.split("/").filter(Boolean),a=o.length;return i=>{const u=i.split("/").filter(Boolean),f=u.length-a;if(f<0||f>0&&r===void 0&&!t)return null;const h={path:a?"":"/",params:{}},y=p=>n===void 0?void 0:n[p];for(let p=0;p<a;p++){const d=o[p],m=u[p],w=d[0]===":",A=w?d.slice(1):d;if(w&&I(m,y(A)))h.params[A]=m;else if(w||!I(m,d))return null;h.path+=`/${m}`}if(r){const p=f?u.slice(-f).join("/"):"";if(I(p,y(r)))h.params[r]=p;else return null}return h}}function I(e,t){const n=s=>s.localeCompare(e,void 0,{sensitivity:"base"})===0;return t===void 0?!0:typeof t=="string"?n(t):typeof t=="function"?t(e):Array.isArray(t)?t.some(n):t instanceof RegExp?t.test(e):!1}function Re(e){const[t,n]=e.pattern.split("/*",2),s=t.split("/").filter(Boolean);return s.reduce((r,o)=>r+(o.startsWith(":")?2:3),s.length-(n===void 0?0:1))}function J(e){const t=new Map,n=oe();return new Proxy({},{get(s,r){return t.has(r)||T(n,()=>t.set(r,v(()=>e()[r]))),t.get(r)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(e())}})}function Q(e){let t=/(\/?\:[^\/]+)\?/.exec(e);if(!t)return[e];let n=e.slice(0,t.index),s=e.slice(t.index+t[0].length);const r=[n,n+=t[1]];for(;t=/^(\/\:[^\/]+)\?/.exec(s);)r.push(n+=t[1]),s=s.slice(t[0].length);return Q(s).reduce((o,a)=>[...o,...r.map(i=>i+a)],[])}const Pe=100,xe=H(),V=H(),D=()=>ye(q(xe),"<A> and 'use' router primitives can be only used inside a Route."),be=()=>q(V)||D().base,_e=e=>{const t=be();return v(()=>t.resolvePath(e()))},Fe=e=>{const t=D();return v(()=>{const n=e();return n!==void 0?t.renderPath(n):n})},Ie=()=>D().location;function Ae(e,t=""){const{component:n,preload:s,load:r,children:o,info:a}=e,i=!o||Array.isArray(o)&&!o.length,u={key:e,component:n,preload:s||r,info:a};return Y(e.path).reduce((f,h)=>{for(const y of Q(h)){const p=ve(t,y);let d=i?p:p.split("/*",1)[0];d=d.split("/").map(m=>m.startsWith(":")||m.startsWith("*")?m:encodeURIComponent(m)).join("/"),f.push({...u,originalPath:h,pattern:d,matcher:we(d,!i,e.matchFilters)})}return f},[])}function Ce(e,t=0){return{routes:e,score:Re(e[e.length-1])*1e4-t,matcher(n){const s=[];for(let r=e.length-1;r>=0;r--){const o=e[r],a=o.matcher(n);if(!a)return null;s.unshift({...a,route:o})}return s}}}function Y(e){return Array.isArray(e)?e:[e]}function Ee(e,t="",n=[],s=[]){const r=Y(e);for(let o=0,a=r.length;o<a;o++){const i=r[o];if(i&&typeof i=="object"){i.hasOwnProperty("path")||(i.path="");const u=Ae(i,t);for(const f of u){n.push(f);const h=Array.isArray(i.children)&&i.children.length===0;if(i.children&&!h)Ee(i.children,f.pattern,n,s);else{const y=Ce([...n],s.length);s.push(y)}n.pop()}}}return n.length?s:s.sort((o,a)=>a.score-o.score)}function $(e,t){for(let n=0,s=e.length;n<s;n++){const r=e[n].matcher(t);if(r)return r}return[]}function Se(e,t){const n=new URL(ge),s=v(u=>{const f=e();try{return new URL(f,n)}catch{return console.error(`Invalid path ${f}`),u}},n,{equals:(u,f)=>u.href===f.href}),r=v(()=>s().pathname),o=v(()=>s().search,!0),a=v(()=>s().hash),i=()=>"";return{get pathname(){return r()},get search(){return o()},get hash(){return a()},get state(){return t()},get key(){return i()},query:J(N(o,()=>G(s())))}}let R;function $e(){return R}function ke(e){}function qe(e,t,n,s={}){const{signal:[r,o],utils:a={}}=e,i=a.parsePath||(c=>c),u=a.renderPath||(c=>c),f=a.beforeLeave||de(),h=L("",s.base||"");if(h===void 0)throw new Error(`${h} is not a valid base path`);h&&!r().value&&o({value:h,replace:!0,scroll:!1});const[y,p]=B(!1);let d;const m=(c,l)=>{l.value===w()&&l.state===C()||(d===void 0&&p(!0),R=c,d=l,ce(()=>{d===l&&(A(d.value),Z(d.state),fe(),M[1]([]))}).finally(()=>{d===l&&ie(()=>{R=void 0,c==="navigate"&&re(d),p(!1),d=void 0})}))},[w,A]=B(r().value),[C,Z]=B(r().state),j=Se(w,C),E=[],M=B([]),U=v(()=>typeof s.transformUrl=="function"?$(t(),s.transformUrl(j.pathname)):$(t(),j.pathname)),ee=J(()=>{const c=U(),l={};for(let g=0;g<c.length;g++)Object.assign(l,c[g].params);return l}),W={pattern:h,path:()=>h,outlet:()=>null,resolvePath(c){return L(h,c)}};return ae(N(r,c=>m("native",c),{defer:!0})),{base:W,location:j,params:ee,isRouting:y,renderPath:u,parsePath:i,navigatorFactory:ne,matches:U,beforeLeave:f,preloadRoute:se,singleFlight:s.singleFlight===void 0?!0:s.singleFlight,submissions:M};function te(c,l,g){le(()=>{if(typeof l=="number"){l&&(a.go?a.go(l):console.warn("Router integration does not support relative routing"));return}const S=!l||l[0]==="?",{replace:_,resolve:P,scroll:F,state:x}={replace:!1,resolve:!S,scroll:!0,...g};let z;const O=P?c.resolvePath(l):L(S&&(z=r().value)&&z.split("?")[0]||"",l);if(O===void 0)throw new Error(`Path '${l}' is not a routable path`);if(E.length>=Pe)throw new Error("Too many redirects");const K=w();(O!==K||x!==C())&&(ue||f.confirm(O,g)&&(E.push({value:K,replace:_,scroll:F,state:C()}),m("navigate",{value:O,state:x})))})}function ne(c){return c=c||q(V)||W,(l,g)=>te(c,l,g)}function re(c){const l=E[0];l&&(o({...c,replace:l.replace,scroll:l.scroll}),E.length=0)}function se(c,l={}){const g=$(t(),c.pathname),S=R;R="preload";for(let _ in g){const{route:P,params:F}=g[_];P.component&&P.component.preload&&P.component.preload();const{preload:x}=P;l.preloadData&&x&&T(n(),()=>x({params:F,location:{pathname:c.pathname,search:c.search,hash:c.hash,query:G(c),state:null,key:""},intent:"preload"}))}R=S}}function De(e,t,n,s){const{base:r,location:o,params:a}=e,{pattern:i,component:u,preload:f}=s().route,h=v(()=>s().path);u&&u.preload&&u.preload();const y=f?f({params:a,location:o,intent:R||"initial"}):void 0;return{parent:t,pattern:i,path:h,outlet:()=>u?he(u,{params:a,location:o,data:y,get children(){return n()}}):n(),resolvePath(d){return L(r.path(),d,h())}}}export{xe as R,qe as a,V as b,Ee as c,De as d,X as e,de as f,$e as g,Fe as h,Ie as i,b as j,Le as k,ge as m,je as n,ke as s,_e as u};
